{
  "resolvedId": "/home/wombocombo/github/wrk/gdg-fsc-website/node_modules/@effect/platform/dist/esm/internal/httpServerResponse.js",
  "transforms": [
    {
      "name": "__load__",
      "result": "import * as Context from \"effect/Context\";\nimport * as Effect from \"effect/Effect\";\nimport * as Effectable from \"effect/Effectable\";\nimport { dual } from \"effect/Function\";\nimport * as Inspectable from \"effect/Inspectable\";\nimport * as Runtime from \"effect/Runtime\";\nimport * as Stream from \"effect/Stream\";\nimport * as Cookies from \"../Cookies.js\";\nimport * as Headers from \"../Headers.js\";\nimport * as Template from \"../Template.js\";\nimport * as UrlParams from \"../UrlParams.js\";\nimport * as internalBody from \"./httpBody.js\";\n/** @internal */\nexport const TypeId = /*#__PURE__*/Symbol.for(\"@effect/platform/HttpServerResponse\");\nconst respondableSymbol = /*#__PURE__*/Symbol.for(\"@effect/platform/HttpServerRespondable\");\nclass ServerResponseImpl extends Effectable.StructuralClass {\n  status;\n  statusText;\n  cookies;\n  body;\n  [TypeId];\n  headers;\n  constructor(status, statusText, headers, cookies, body) {\n    super();\n    this.status = status;\n    this.statusText = statusText;\n    this.cookies = cookies;\n    this.body = body;\n    this[TypeId] = TypeId;\n    if (body.contentType || body.contentLength) {\n      const newHeaders = {\n        ...headers\n      };\n      if (body.contentType) {\n        newHeaders[\"content-type\"] = body.contentType;\n      }\n      if (body.contentLength) {\n        newHeaders[\"content-length\"] = body.contentLength.toString();\n      }\n      this.headers = newHeaders;\n    } else {\n      this.headers = headers;\n    }\n  }\n  commit() {\n    return Effect.succeed(this);\n  }\n  [respondableSymbol]() {\n    return Effect.succeed(this);\n  }\n  [Inspectable.NodeInspectSymbol]() {\n    return this.toJSON();\n  }\n  toString() {\n    return Inspectable.format(this);\n  }\n  toJSON() {\n    return {\n      _id: \"@effect/platform/HttpServerResponse\",\n      status: this.status,\n      statusText: this.statusText,\n      headers: Inspectable.redact(this.headers),\n      cookies: this.cookies.toJSON(),\n      body: this.body.toJSON()\n    };\n  }\n}\n/** @internal */\nexport const isServerResponse = u => typeof u === \"object\" && u !== null && TypeId in u;\n/** @internal */\nexport const empty = options => new ServerResponseImpl(options?.status ?? 204, options?.statusText, options?.headers ? Headers.fromInput(options.headers) : Headers.empty, options?.cookies ?? Cookies.empty, internalBody.empty);\n/** @internal */\nexport const redirect = (location, options) => {\n  const headers = Headers.unsafeFromRecord({\n    location: location.toString()\n  });\n  return new ServerResponseImpl(options?.status ?? 302, options?.statusText, options?.headers ? Headers.merge(headers, Headers.fromInput(options.headers)) : headers, options?.cookies ?? Cookies.empty, internalBody.empty);\n};\n/** @internal */\nexport const uint8Array = (body, options) => {\n  const headers = options?.headers ? Headers.fromInput(options.headers) : Headers.empty;\n  return new ServerResponseImpl(options?.status ?? 200, options?.statusText, headers, options?.cookies ?? Cookies.empty, internalBody.uint8Array(body, getContentType(options, headers)));\n};\n/** @internal */\nexport const text = (body, options) => {\n  const headers = options?.headers ? Headers.fromInput(options.headers) : Headers.empty;\n  return new ServerResponseImpl(options?.status ?? 200, options?.statusText, headers, options?.cookies ?? Cookies.empty, internalBody.text(body, getContentType(options, headers)));\n};\n/** @internal */\nexport const html = (strings, ...args) => {\n  if (typeof strings === \"string\") {\n    return text(strings, {\n      contentType: \"text/html\"\n    });\n  }\n  return Effect.map(Template.make(strings, ...args), _ => text(_, {\n    contentType: \"text/html\"\n  }));\n};\n/** @internal */\nexport const htmlStream = (strings, ...args) => Effect.map(Effect.context(), context => stream(Stream.provideContext(Stream.encodeText(Template.stream(strings, ...args)), context), {\n  contentType: \"text/html\"\n}));\n/** @internal */\nexport const json = (body, options) => Effect.map(internalBody.json(body), body => new ServerResponseImpl(options?.status ?? 200, options?.statusText, options?.headers ? Headers.fromInput(options.headers) : Headers.empty, options?.cookies ?? Cookies.empty, body));\n/** @internal */\nexport const unsafeJson = (body, options) => new ServerResponseImpl(options?.status ?? 200, options?.statusText, options?.headers ? Headers.fromInput(options.headers) : Headers.empty, options?.cookies ?? Cookies.empty, internalBody.unsafeJson(body));\n/** @internal */\nexport const schemaJson = (schema, options) => {\n  const encode = internalBody.jsonSchema(schema, options);\n  return (body, options) => Effect.map(encode(body), body => new ServerResponseImpl(options?.status ?? 200, options?.statusText, options?.headers ? Headers.fromInput(options.headers) : Headers.empty, options?.cookies ?? Cookies.empty, body));\n};\nconst httpPlatform = /*#__PURE__*/Context.GenericTag(\"@effect/platform/HttpPlatform\");\n/** @internal */\nexport const file = (path, options) => Effect.flatMap(httpPlatform, platform => platform.fileResponse(path, options));\n/** @internal */\nexport const fileWeb = (file, options) => Effect.flatMap(httpPlatform, platform => platform.fileWebResponse(file, options));\n/** @internal */\nexport const urlParams = (body, options) => new ServerResponseImpl(options?.status ?? 200, options?.statusText, options?.headers ? Headers.fromInput(options.headers) : Headers.empty, options?.cookies ?? Cookies.empty, internalBody.text(UrlParams.toString(UrlParams.fromInput(body)), \"application/x-www-form-urlencoded\"));\n/** @internal */\nexport const raw = (body, options) => new ServerResponseImpl(options?.status ?? 200, options?.statusText, options?.headers ? Headers.fromInput(options.headers) : Headers.empty, options?.cookies ?? Cookies.empty, internalBody.raw(body, {\n  contentType: options?.contentType,\n  contentLength: options?.contentLength\n}));\n/** @internal */\nexport const formData = (body, options) => new ServerResponseImpl(options?.status ?? 200, options?.statusText, options?.headers ? Headers.fromInput(options.headers) : Headers.empty, options?.cookies ?? Cookies.empty, internalBody.formData(body));\n/** @internal */\nexport const stream = (body, options) => {\n  const headers = options?.headers ? Headers.fromInput(options.headers) : Headers.empty;\n  return new ServerResponseImpl(options?.status ?? 200, options?.statusText, headers, options?.cookies ?? Cookies.empty, internalBody.stream(body, getContentType(options, headers), options?.contentLength));\n};\n/** @internal */\nexport const getContentType = (options, headers) => {\n  if (options?.contentType) {\n    return options.contentType;\n  } else if (options?.headers) {\n    return headers[\"content-type\"];\n  } else {\n    return;\n  }\n};\n/** @internal */\nexport const setHeader = /*#__PURE__*/dual(3, (self, key, value) => new ServerResponseImpl(self.status, self.statusText, Headers.set(self.headers, key, value), self.cookies, self.body));\n/** @internal */\nexport const replaceCookies = /*#__PURE__*/dual(2, (self, cookies) => new ServerResponseImpl(self.status, self.statusText, self.headers, cookies, self.body));\n/** @internal */\nexport const setCookie = /*#__PURE__*/dual(args => isServerResponse(args[0]), (self, name, value, options) => Effect.map(Cookies.set(self.cookies, name, value, options), cookies => new ServerResponseImpl(self.status, self.statusText, self.headers, cookies, self.body)));\n/** @internal */\nexport const unsafeSetCookie = /*#__PURE__*/dual(args => isServerResponse(args[0]), (self, name, value, options) => new ServerResponseImpl(self.status, self.statusText, self.headers, Cookies.unsafeSet(self.cookies, name, value, options), self.body));\n/** @internal */\nexport const updateCookies = /*#__PURE__*/dual(2, (self, f) => new ServerResponseImpl(self.status, self.statusText, self.headers, f(self.cookies), self.body));\n/** @internal */\nexport const setCookies = /*#__PURE__*/dual(2, (self, cookies) => Effect.map(Cookies.setAll(self.cookies, cookies), cookies => new ServerResponseImpl(self.status, self.statusText, self.headers, cookies, self.body)));\n/** @internal */\nexport const mergeCookies = /*#__PURE__*/dual(2, (self, cookies) => new ServerResponseImpl(self.status, self.statusText, self.headers, Cookies.merge(self.cookies, cookies), self.body));\n/** @internal */\nexport const unsafeSetCookies = /*#__PURE__*/dual(2, (self, cookies) => new ServerResponseImpl(self.status, self.statusText, self.headers, Cookies.unsafeSetAll(self.cookies, cookies), self.body));\n/** @internal */\nexport const removeCookie = /*#__PURE__*/dual(2, (self, name) => new ServerResponseImpl(self.status, self.statusText, self.headers, Cookies.remove(self.cookies, name), self.body));\n/** @internal */\nexport const expireCookie = /*#__PURE__*/dual(3, (self, name, options) => new ServerResponseImpl(self.status, self.statusText, self.headers, Cookies.unsafeSet(self.cookies, name, \"\", {\n  ...(options ?? {}),\n  maxAge: 0\n}), self.body));\n/** @internal */\nexport const setHeaders = /*#__PURE__*/dual(2, (self, input) => new ServerResponseImpl(self.status, self.statusText, Headers.setAll(self.headers, input), self.cookies, self.body));\n/** @internal */\nexport const setStatus = /*#__PURE__*/dual(args => isServerResponse(args[0]), (self, status, statusText) => new ServerResponseImpl(status, statusText, self.headers, self.cookies, self.body));\n/** @internal */\nexport const setBody = /*#__PURE__*/dual(2, (self, body) => {\n  let headers = self.headers;\n  if (body._tag === \"Empty\") {\n    headers = Headers.remove(Headers.remove(headers, \"Content-Type\"), \"Content-length\");\n  }\n  return new ServerResponseImpl(self.status, self.statusText, headers, self.cookies, body);\n});\n/** @internal */\nexport const toWeb = (response, options) => {\n  const headers = new globalThis.Headers(response.headers);\n  if (!Cookies.isEmpty(response.cookies)) {\n    const toAdd = Cookies.toSetCookieHeaders(response.cookies);\n    for (const header of toAdd) {\n      headers.append(\"set-cookie\", header);\n    }\n  }\n  if (options?.withoutBody) {\n    return new Response(undefined, {\n      status: response.status,\n      statusText: response.statusText,\n      headers\n    });\n  }\n  const body = response.body;\n  switch (body._tag) {\n    case \"Empty\":\n      {\n        return new Response(undefined, {\n          status: response.status,\n          statusText: response.statusText,\n          headers\n        });\n      }\n    case \"Uint8Array\":\n    case \"Raw\":\n      {\n        if (body.body instanceof Response) {\n          for (const [key, value] of headers) {\n            body.body.headers.set(key, value);\n          }\n          return body.body;\n        }\n        return new Response(body.body, {\n          status: response.status,\n          statusText: response.statusText,\n          headers\n        });\n      }\n    case \"FormData\":\n      {\n        return new Response(body.formData, {\n          status: response.status,\n          statusText: response.statusText,\n          headers\n        });\n      }\n    case \"Stream\":\n      {\n        return new Response(Stream.toReadableStreamRuntime(body.stream, options?.runtime ?? Runtime.defaultRuntime), {\n          status: response.status,\n          statusText: response.statusText,\n          headers\n        });\n      }\n  }\n};\n//# sourceMappingURL=httpServerResponse.js.map",
      "start": 1768772628752,
      "end": 1768772628752
    },
    {
      "name": "sentry-vite-component-name-annotate-plugin",
      "start": 1768772628752,
      "end": 1768772628768,
      "order": "pre"
    },
    {
      "name": "comlink",
      "start": 1768772628772,
      "end": 1768772628785,
      "order": "normal"
    },
    {
      "name": "sentry-vite-bundle-size-optimizations-plugin",
      "start": 1768772628792,
      "end": 1768772628803,
      "order": "normal"
    },
    {
      "name": "vite-plugin-csp-guard",
      "start": 1768772628808,
      "end": 1768772628811,
      "order": "post-post"
    }
  ]
}
